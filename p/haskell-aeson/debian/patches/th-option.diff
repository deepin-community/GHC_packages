--- a/aeson.cabal
+++ b/aeson.cabal
@@ -78,6 +78,10 @@ flag cffi
   default: True
   manual: True
 
+flag th
+  description: build TH bits
+  default: True
+
 library
   default-language: Haskell2010
   hs-source-dirs: .
@@ -88,12 +92,14 @@ library
     Data.Aeson.Parser
     Data.Aeson.Text
     Data.Aeson.Types
-    Data.Aeson.TH
 
     Data.Aeson.Encoding.Internal
     Data.Aeson.Internal
     Data.Aeson.Internal.Time
 
+  if flag(th)
+      exposed-modules: Data.Aeson.TH
+
   -- Deprecated modules
   exposed-modules:
     Data.Aeson.Encode
