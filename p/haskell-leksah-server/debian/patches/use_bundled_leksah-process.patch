Index: haskell-leksah-server-0.8.0.6/leksah-server.cabal
===================================================================
--- haskell-leksah-server-0.8.0.6.orig/leksah-server.cabal	2010-06-12 12:58:26.000000000 +0200
+++ haskell-leksah-server-0.8.0.6/leksah-server.cabal	2010-06-12 13:08:21.000000000 +0200
@@ -31,7 +31,7 @@
                binary-shared >=0.8, bytestring >=0.9.0.1, containers >=0.2.0.0,
                directory >=1.0.0.2, filepath >=1.1.0.1, ghc >=6.10.1,
                ltk >=0.8 && <= 0.9, mtl >=1.1.0.2, parsec >=2.1.0.1,
-               pretty >=1.0.1.0, process-leksah >=1.0.1.3, time >= 1.1, deepseq >= 1.1,
+               pretty >=1.0.1.0, time >= 1.1, deepseq >= 1.1,
                hslogger >= 1.0.7, network >= 2.2 && <= 3.0
     if (impl(ghc >= 6.12))
        build-depends: haddock >= 2.7.2
@@ -67,12 +67,24 @@
        ghc-options: -Wall -ferror-spans -O2
     ghc-prof-options: -auto-all -prof

+    -- Bundled leksah-process
+    exposed-modules:
+        IDE.System.Process
+        IDE.System.Process.Internals
+    c-sources:
+        process-leksah/cbits/runProcess.c
+    include-dirs: process-leksah/include
+    includes:
+        runProcess.h
+    cpp-options: -Dbase4
+    hs-source-dirs: process-leksah
+
 executable leksah-server
     build-depends: Cabal >=1.6.0.1, base >= 4.0.0.0 && <= 5, binary >=0.5.0.0,
                binary-shared >=0.8, bytestring >=0.9.0.1, containers >=0.2.0.0,
                directory >=1.0.0.2, filepath >=1.1.0.1, ghc >=6.10.1,
                ltk >=0.8 && <= 0.9, mtl >=1.1.0.2, parsec >=2.1.0.1,
-               pretty >=1.0.1.0, process-leksah >=1.0.1.3, deepseq >= 1.1, network >= 2.2 && <= 3.0
+               pretty >=1.0.1.0, deepseq >= 1.1, network >= 2.2 && <= 3.0
     if (impl(ghc >= 6.12))
        build-depends: haddock >= 2.7.2
     else
@@ -106,6 +118,13 @@
        ghc-options: -Wall -ferror-spans -threaded -O2
     ghc-prof-options: -auto-all -prof

+    -- Bundled leksah-process
+    c-sources:
+        process-leksah/cbits/runProcess.c
+    include-dirs: process-leksah/include
+    cpp-options: -Dbase4
+    hs-source-dirs: process-leksah
+
 executable leksahecho
     main-is: LeksahEcho.hs
     buildable: True
@@ -118,4 +137,9 @@
     else
        ghc-options: -Wall -ferror-spans -threaded -O2

-
+    -- Bundled leksah-process
+    c-sources:
+        process-leksah/cbits/runProcess.c
+    include-dirs: process-leksah/include
+    cpp-options: -Dbase4
+    hs-source-dirs: process-leksah
