#!/usr/bin/make -f

DEB_BUILD_DEPENDENCIES = build-arch

include /usr/share/cdbs/1/rules/debhelper.mk
include /usr/share/cdbs/1/class/hlibrary.mk
include /usr/share/cdbs/1/rules/patchsys-quilt.mk

DEB_COMPRESS_EXCLUDE  = .pdf

PICS = equiv haskore poly

PDF_PICS = $(patsubst %, src/Doc/Pics/%.pdf, $(PICS))

TEX_FILES = $(patsubst %, src/Doc/%, \
			Tutorial.tex             \
			Discussion.tex           \
			Introduction.tex         \
			Macros.tex               \
			Related.tex)

%.pdf:	%.eps
	epstopdf $<

GHC_MODULES = $(patsubst %, src/%,               \
			$(MEDIA)                             \
			Test/Equivalence.lhs Test/Suite.lhs) \
			$(patsubst %, src/Haskore/%, $(MODULES) )

build/libghc6-haskore-doc::	$(TEX_FILES) $(GHC_MODULES) $(PDF_PICS)
	TEXINPUTS=src:src/Doc:$(TEXINPUTS) pdflatex $<
	bibtex Tutorial
	mkindex Tutorial
	TEXINPUTS=src:src/Doc:$(TEXINPUTS) pdflatex $<
	TEXINPUTS=src:src/Doc:$(TEXINPUTS) pdflatex $<

clean::
	rm -f Tutorial.*
	dh_testdir
