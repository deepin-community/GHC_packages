From 59c4bf5c8b2cffb7b293bbc034310914a6c3bd20 Mon Sep 17 00:00:00 2001
From: Greg V <greg@unrelenting.technology>
Date: Wed, 26 Apr 2017 16:18:37 +0300
Subject: [PATCH] fix #5

---
 stack.yaml                          | 2 +-
 test-suite/Network/HTTP/LinkSpec.hs | 3 ++-
 2 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/test-suite/Network/HTTP/LinkSpec.hs b/test-suite/Network/HTTP/LinkSpec.hs
index f7cad35..9c98733 100644
--- a/test-suite/Network/HTTP/LinkSpec.hs
+++ b/test-suite/Network/HTTP/LinkSpec.hs
@@ -21,7 +21,8 @@ instance Arbitrary Link where
     params ← listOf genParam
     return $ fromJust $ lnk (mconcat [urlScheme, urlDomain, ".", urlTld, "/", urlPath]) params
     where genParam = do
-            otherParamKey ← listOf1 $ elements ['a'..'z']
+            otherParamKey ← suchThat (listOf1 $ elements ['a'..'z']) (\x → x /= "rel" && x /= "rev" && x /= "title"
+              && x /= "title*" && x /= "hreflang" && x /= "anchor" && x /= "media" && x /= "type")
             paramKey ← elements [Rel, Rev, Title, Hreflang, Anchor, Media, ContentType, Other (T.pack otherParamKey)]
             paramValue ← listOf $ elements ['a'..'z']
             return (paramKey, T.pack paramValue)
