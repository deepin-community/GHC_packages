## 04_no-hugs-package-cmd.dpatch by Arjan Oosting <arjanoosting@home.nl>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: No description.

@DPATCH@
Index: haxml-1.19.7/Makefile
===================================================================
--- haxml-1.19.7.orig/Makefile
+++ haxml-1.19.7/Makefile
@@ -77,7 +77,14 @@
 install-nhc98:
	cd obj/nhc98; $(MAKE) HC=nhc98 install-nhc98
 install-hugs:
-	hugs-package src
+	mkdir -p $(DESTDIR)/usr/lib/hugs/packages/HaXml/Text/XML/HaXml/Html
+	mkdir -p $(DESTDIR)/usr/lib/hugs/packages/HaXml/Text/XML/HaXml/Xtract
+	mkdir -p $(DESTDIR)/usr/lib/hugs/packages/HaXml/Text/XML/HaXml/DtdToHaskell
+	mkdir -p $(DESTDIR)/usr/lib/hugs/packages/HaXml/Text/ParserCombinators
+	for file in $(patsubst src/%, %, $(SRCS)); \
+		do $(CPP) -D__HUGS__ src/$$file > \
+			$(DESTDIR)/usr/lib/hugs/packages/HaXml/$$file; \
+		done
	cd obj/hugs; $(MAKE) install-tools-hugs
 install-filesonly-ghc:
	cd obj/ghc; $(MAKE) HC=$(shell cat obj/ghccmd) install-filesonly-ghc
